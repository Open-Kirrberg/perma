(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5142],{980:(e,t,n)=>{"use strict";n.d(t,{A:()=>w});var o,r=n(6540),a=n(3481),i=n.n(a),l=n(4957),s=new Uint8Array(16);function c(){if(!o&&!(o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(s)}const d=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const u=function(e){return"string"==typeof e&&d.test(e)};for(var p=[],m=0;m<256;++m)p.push((m+256).toString(16).substr(1));const h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(p[e[t+0]]+p[e[t+1]]+p[e[t+2]]+p[e[t+3]]+"-"+p[e[t+4]]+p[e[t+5]]+"-"+p[e[t+6]]+p[e[t+7]]+"-"+p[e[t+8]]+p[e[t+9]]+"-"+p[e[t+10]]+p[e[t+11]]+p[e[t+12]]+p[e[t+13]]+p[e[t+14]]+p[e[t+15]]).toLowerCase();if(!u(n))throw TypeError("Stringified UUID is invalid");return n};const b=function(e,t,n){var o=(e=e||{}).random||(e.rng||c)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){n=n||0;for(var r=0;r<16;++r)t[n+r]=o[r];return t}return h(o)};var g=n(4848);const y=e=>{let{map:t}=e;const[n,o]=(0,r.useState)([]),[a,l]=(0,r.useState)(null),s=(e,n)=>{const r={size:5*Math.random()+1},a={id:b(),kind:"Unknown",planter:"Anonymous",birth:(new Date).toISOString().split("T")[0],size:r.size.toFixed(2),lat:e,lon:n,notes:[],yearlyReports:[]};var s;s=a,o((e=>[...e,s])),i().marker([s.lat,s.lon],{icon:i().divIcon({className:"tree-icon",html:"\ud83c\udf33",iconSize:[24,24],iconAnchor:[12,12]})}).addTo(t).bindPopup(`<b>${s.kind}</b><br>Planted by: ${s.planter}<br>Birth: ${s.birth}<br>Size: ${s.size}m`).on("click",(()=>{l(s)}))};return(0,g.jsxs)("div",{children:[(0,g.jsx)("button",{onClick:()=>{const e=t.getCenter();s(e.lat,e.lng)},children:"Add Tree at Center"}),a&&(0,g.jsxs)("div",{children:[(0,g.jsx)("h3",{children:"Selected Tree"}),(0,g.jsxs)("p",{children:["Kind: ",a.kind]}),(0,g.jsxs)("p",{children:["Planter: ",a.planter]}),(0,g.jsxs)("p",{children:["Size: ",a.size,"m"]}),(0,g.jsxs)("p",{children:["Birth: ",a.birth]}),(0,g.jsx)("button",{onClick:()=>{return e=a.id,t=prompt("Enter a note for this tree"),void o((n=>n.map((n=>n.id===e?{...n,notes:[...n.notes,t]}:n))));var e,t},children:"Add Note"}),(0,g.jsx)("button",{onClick:()=>{return e=a.id,t=prompt("Enter a yearly report for this tree"),void o((n=>n.map((n=>n.id===e?{...n,yearlyReports:[...n.yearlyReports,t]}:n))));var e,t},children:"Add Yearly Report"})]}),(0,g.jsx)("div",{children:(0,g.jsxs)("h3",{children:["Total Area Value: ",n.reduce(((e,t)=>e+10*parseFloat(t.size)),0).toFixed(2)," currency units"]})})]})},f=e=>{let{map:t}=e;const[n,o]=(0,r.useState)([]),a=i().divIcon({className:"tree-icon",html:"\ud83c\udf33",iconSize:[24,24],iconAnchor:[12,12]});return(0,r.useEffect)((()=>{t&&(async()=>{try{const e=await fetch("/data/trees/2900.json"),n=await e.json();console.log("json"),console.log(n),o(n.trees),n.trees.forEach((e=>{i().marker([e.lat,e.lon],{icon:a}).addTo(t).bindPopup(`\n          <b>${e.name}</b><br>\n          <ul>\n            <li><b>Kind:</b> ${e.kind}</li>\n            <li><b>Height:</b> ${e.height} m</li>\n            <li><b>Birth Date:</b> ${e.birth}</li>\n            <li><b>Planter:</b> ${e.planter}</li>\n            <li><b>Notes:</b> ${e.notes}</li>\n          </ul>\n        `)}))}catch(e){console.error("Failed to load trees:",e)}})()}),[t]),null},v=e=>{let{map:t,onTreeAdded:n}=e;const[o,a]=(0,r.useState)(!1),[l,s]=(0,r.useState)(null),[c,d]=(0,r.useState)(null);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("button",{onClick:()=>{if(!t)return;a(!0);const e=i().divIcon({className:"tree-icon",html:"\ud83c\udf33",iconSize:[24,24],iconAnchor:[12,12]}),o=t.getCenter(),r=i().marker(o,{draggable:!0,icon:e}).addTo(t);s(r),d(o);const l=()=>{const e=t.getCenter();r.setLatLng(e),d(e)};t.on("move",l);const c=()=>{t.off("move",l),t.removeLayer(r),a(!1),s(null),d(null);let e=document.getElementsByClassName("create-tree-controls");e.length>0&&e[0].remove()},u=i().control({position:"topright"});u.onAdd=()=>{console.log("onAdd");const e=i().DomUtil.create("div","create-tree-controls");return e.innerHTML='\n        <button id="set-tree" class="button button--primary" style="margin-right: 5px;">Set</button>\n        <button id="cancel-tree" class="button button--danger" >Cancel</button>\n      ',e},u.addTo(t),document.getElementById("set-tree").onclick=()=>{const e=r.getLatLng();c(),n({id:Date.now(),name:"New Tree",kind:"",height:0,birth:(new Date).toISOString().split("T")[0],planter:"",notes:"",lat:e.lat,lon:e.lng})},document.getElementById("cancel-tree").onclick=()=>{c()}},style:{},children:"Add New Tree"}),"test"]})},x=(e,t,n,o)=>{const r=document.createElement("div"),a=i().divIcon({className:"tree-icon",html:"\ud83c\udf33",iconSize:[24,24],iconAnchor:[12,12]});r.id=`tree-${t.id}`;const l=`\n      <b>${t.name}</b><br>\n      <ul>\n        <li><b>Kind:</b> ${t.kind}</li>\n        <li><b>Height:</b> ${t.height} m</li>\n        <li><b>Birth Date:</b> ${t.birth}</li>\n        <li><b>Planter:</b> ${t.planter}</li>\n        <li><b>Notes:</b> ${t.notes}</li>\n      </ul>\n    `;r.innerHTML=l;const s=document.createElement("button");s.classList.add("button","button-primary"),s.textContent="Edit",s.onclick=()=>{const r=document.createElement("form");r.innerHTML=`\n          <label>\n            Name:\n            <input type="text" name="name" value="${t.name}" />\n          </label>\n          <br />\n          <label>\n            Kind:\n            <input type="text" name="kind" value="${t.kind}" />\n          </label>\n          <br />\n          <label>\n            Height (m):\n            <input type="number" name="height" step="0.01" value="${t.height}" />\n          </label>\n          <br />\n          <label>\n            Birth Date:\n            <input type="date" name="birth" value="${t.birth}" />\n          </label>\n          <br />\n          <label>\n            Planter:\n            <input type="text" name="planter" value="${t.planter}" />\n          </label>\n          <br />\n          <label>\n            Notes:\n            <textarea name="notes">${t.notes}</textarea>\n          </label>\n          <br />\n          <button type="submit" class="button button-primary" style="margin-right: 5px;">Save</button>\n          <button type="button" id="cancel-edit">Cancel</button>\n        `;i().popup().setLatLng([t.lat,t.lon]).setContent(r).openOn(e);r.onsubmit=l=>{l.preventDefault();const s={...t,name:r.name.value,kind:r.kind.value,height:parseFloat(r.height.value),birth:r.birth.value,planter:r.planter.value,notes:r.notes.value};n(s,t),e.closePopup(),e.eachLayer((n=>{n instanceof i().Marker&&n.getLatLng().equals([t.lat,t.lon])&&e.removeLayer(n)}));i().marker([s.lat,s.lon],{icon:a}).addTo(e).bindPopup(x(e,s,n,o))},document.getElementById("cancel-edit").onclick=()=>{e.closePopup()}};const c=document.createElement("button");return c.classList.add("button","button-primary"),c.textContent="Download JSON",c.onclick=()=>{const e=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),o=document.createElement("a");o.href=n,o.download=`tree_${t.id}.json`,o.click(),URL.revokeObjectURL(n)},r.appendChild(s),r.appendChild(c),r},S=(e,t,n,o)=>{const r=e=>e*Math.PI/180,a=r(n-e),i=r(o-t),l=Math.sin(a/2)*Math.sin(a/2)+Math.cos(r(e))*Math.cos(r(n))*Math.sin(i/2)*Math.sin(i/2);return 6371e3*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))},k=e=>{let{map:t}=e;const[n,o]=(0,r.useState)([]),[a,l]=(0,r.useState)(null),[s,c]=(0,r.useState)(!1),[d,u]=(0,r.useState)(null);(0,r.useEffect)((()=>{if(!t||!s)return;const e=e=>{const r=[e.latlng.lat,e.latlng.lng];if(0===n.length)o([r]);else if(1===n.length){o((e=>[...e,r]));const[e,a]=n[0],[i,s]=r;l(S(e,a,i,s)),d&&(t.removeLayer(d),u(null))}},r=e=>{if(1===n.length){const[o,r]=n[0],[a,s]=[e.latlng.lat,e.latlng.lng],c=S(o,r,a,s);l(c),d&&t.removeLayer(d);const p=i().polyline([n[0],[a,s]],{color:"blue",dashArray:"5, 5"}).addTo(t);u(p)}},a=()=>{d&&(t.removeLayer(d),u(null))};return t.on("click",e),t.on("mousemove",r),t.on("mouseout",a),()=>{t.off("click",e),t.off("mousemove",r),t.off("mouseout",a)}}),[t,s,n,d]);const p=()=>{o([]),l(null),d&&(t.removeLayer(d),u(null))};return(0,g.jsxs)("div",{children:[(0,g.jsx)("h4",{children:"Distance Measurement Tool"}),(0,g.jsx)("button",{onClick:()=>{c((e=>!e)),s&&p()},style:{marginBottom:"10px"},children:s?"Disable Measurement":"Enable Measurement"}),s&&(0,g.jsxs)(g.Fragment,{children:[0===n.length&&(0,g.jsx)("p",{children:"Click on the map to set the first point."}),1===n.length&&(0,g.jsx)("p",{children:"Move the mouse to preview the distance, then click to set the second point."}),a&&(0,g.jsxs)("p",{children:["Distance: ",(0,g.jsxs)("b",{children:[a.toFixed(2)," meters"]})]}),(0,g.jsx)("button",{onClick:p,style:{marginTop:"10px"},children:"Reset"})]})]})},j=e=>{let{map:t}=e;const[n,o]=(0,r.useState)(!1),[a,l]=(0,r.useState)(!1),[s,c]=(0,r.useState)(null),[d,u]=(0,r.useState)([]),[p,m]=(0,r.useState)(null),[h,b]=(0,r.useState)(null);(0,r.useEffect)((()=>{if(!t)return;const e=i().divIcon({className:"normal-bauer-icon",html:"\ud83d\udc68\u200d\ud83c\udf3e",iconSize:[25,25],iconAnchor:[12,12]}),o=i().divIcon({className:"precise-semi-icon",html:'<span style="font-size:20px; color:red;">\ud83d\udccd</span>',iconSize:[20,20],iconAnchor:[10,10]});if(!n)return p&&(navigator.geolocation.clearWatch(p),m(null)),d.forEach((e=>t.removeLayer(e))),u([]),void(s&&(t.removeLayer(s),c(null)));if(p&&(navigator.geolocation.clearWatch(p),m(null)),(async()=>{if(navigator.permissions)try{if("denied"===(await navigator.permissions.query({name:"geolocation"})).state)return void alert("Bitte aktiviere den Standortzugriff in deinen Browser-Einstellungen.")}catch(e){console.error("Fehler beim Pr\xfcfen der Geolocation-Permissions:",e)}})(),navigator.geolocation){const n=navigator.geolocation.watchPosition((n=>{const{latitude:r,longitude:l}=n.coords;if(b([r,l]),a){d.forEach((e=>t.removeLayer(e))),u([]),s&&(t.removeLayer(s),c(null));const e=i().marker([r,l],{icon:o}).addTo(t);e.bindPopup(`\n              Genauer Standort: ${r.toFixed(6)}, ${l.toFixed(6)}<br>\n              `),c(e),t.setView([r,l],19)}else{const n=i().marker([r,l],{icon:e}).addTo(t);n.bindPopup("Position aktualisiert (Bauer)"),u((e=>[...e,n]))}}),(e=>{console.error("Geolocation-Fehler:",e),1===e.code&&alert("Bitte erlaube den Standortzugriff im Browser, damit deine Position angezeigt werden kann.")}),{enableHighAccuracy:!0});m(n)}return()=>{p&&navigator.geolocation.clearWatch(p)}}),[n,a,t]);return(0,g.jsxs)("div",{style:{display:"flex",gap:"1rem"},children:[(0,g.jsx)("button",{className:"button button--primary",onClick:()=>o(!n),children:n?"Standort ausblenden":"Standort anzeigen"}),(0,g.jsx)("button",{className:"button button--secondary",onClick:()=>l(!a),disabled:!n,children:a?"Pr\xe4zisen Modus aus":"Pr\xe4zisen Modus an"}),(0,g.jsx)("button",{className:"button button--secondary",onClick:()=>{t&&h&&t.setView(h,a?19:16)},disabled:!n||!h,children:"Zum aktuellen Standort springen"}),(0,g.jsx)("button",{className:"button button--danger",onClick:()=>{t&&(d.forEach((e=>t.removeLayer(e))),u([]),s&&(t.removeLayer(s),c(null)))},disabled:!t,children:"Remove all Location Markers"})]})},L=[{id:"2900",label:"2900"},{id:"2901",label:"2901"},{id:"2902-4",label:"2902-4"}],w=()=>{const[e,t]=(0,r.useState)(null),[o,a]=(0,r.useState)(null),[s,c]=(0,r.useState)(!1),d=(0,r.useRef)({}),u=i().divIcon({className:"tree-icon",html:"\ud83c\udf33",iconSize:[24,24],iconAnchor:[12,12]}),p=(e,t)=>{console.log("Updated Tree:",e)},m=e=>{console.log("downloadTree Tree:",e)},h=(e,t)=>{const[n,o]=(0,l.A)("+proj=utm +zone=32 +ellps=GRS80 +datum=WGS84 +units=m +no_defs","+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs",[e,t]);return[o,n]},b=e=>{if("MultiPolygon"===e.geometry.type){const t=e.geometry.coordinates.map((e=>e.map((e=>e.map((e=>{let[t,n]=e;const[o,r]=h(t,n);return[r,o]}))))));return{...e,geometry:{...e.geometry,coordinates:t}}}if("Polygon"===e.geometry.type){const t=e.geometry.coordinates.map((e=>e.map((e=>{let[t,n]=e;const[o,r]=h(t,n);return[r,o]}))));return{...e,geometry:{...e.geometry,coordinates:t}}}return e};(0,r.useEffect)((()=>{const e=i().map("map").setView([49.29344,7.353419],17),o={Normal:i().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(e),Realistic:i().tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:'&copy; <a href="https://2gis.com">2GIS</a>'})};i().control.layers(o).addTo(e);return[{id:1,name:"Apple Tree",lat:49.313,lon:7.34}].forEach((t=>{const n=i().marker([t.lat,t.lon],{icon:u}).addTo(e).bindPopup(`<b>${t.name}</b>`);n.on("click",(()=>{n.openPopup(),n.setZIndexOffset(1e3)}))})),(async()=>{const e=n(9804),t=[];for(const n of e.keys()){const o=await e(n),r={...o,features:o.features.map(b)};t.push(r)}return t})().then((t=>{t.forEach((t=>{i().geoJSON(t,{style:{color:"#3d6b3d",weight:3},onEachFeature:(e,t)=>{e.properties.FLZ&&(d.current[e.properties.FLZ]=t),t.bindPopup(`<b>Area ID: ${e.properties.FLZ}</b><br>Name: ${e.properties.NAME}`),t.on("click",(()=>{t.setStyle({color:"#ff6b35",weight:5}),setTimeout((()=>t.setStyle({color:"#3d6b3d",weight:3})),1500)}))}}).addTo(e)}))})),e.on("click",(t=>{const{lat:n,lng:o}=t.latlng,r=`\n        <div>\n          <p>Latitude: ${n.toFixed(6)}</p>\n          <p>Longitude: ${o.toFixed(6)}</p>\n          <p>\n            <a href="https://www.google.com/maps?q=${n},${o}" target="_blank">\n              Navigate with Google Maps\n            </a>\n          </p>\n        </div>\n      `;i().popup().setLatLng(t.latlng).setContent(r).openOn(e)})),t(e),()=>{e.remove()}}),[]);return(0,g.jsxs)("div",{className:"map-container-wrapper",children:[(0,g.jsx)("a",{href:"/",className:"map-back-btn",title:"Zur\xfcck zur Startseite",children:"\u2190 Zur\xfcck"}),(0,g.jsx)("div",{className:"area-selector",children:L.map((t=>(0,g.jsx)("button",{className:"area-btn "+(o===t.id?"active":""),onClick:()=>(t=>{if(!e)return;Object.values(d.current).forEach((e=>{e.setStyle({color:"#3d6b3d",weight:3})}));const n=d.current[t];n&&(a(t),n.setStyle({color:"#ff6b35",weight:5}),e.fitBounds(n.getBounds(),{padding:[20,20]}),n.openPopup())})(t.id),children:t.label},t.id)))}),(0,g.jsx)("div",{id:"map",style:{height:"100vh",width:"100%"}}),(0,g.jsxs)("div",{className:"map-tools-panel "+(s?"expanded":""),children:[(0,g.jsx)("button",{className:"tools-toggle",onClick:()=>c(!s),children:s?"\u2715 Schlie\xdfen":"\u2699\ufe0f Tools"}),s&&(0,g.jsxs)("div",{className:"tools-content",children:[e&&(0,g.jsx)(k,{map:e}),e&&(0,g.jsx)(v,{map:e,onTreeAdded:t=>{i().marker([t.lat,t.lon],{icon:u}).addTo(e).bindPopup(x(e,t,p,m))}}),e&&(0,g.jsx)(y,{map:e})]})]}),(0,g.jsx)("div",{className:"location-control-overlay",children:e&&(0,g.jsx)(j,{map:e})}),e&&(0,g.jsx)(f,{map:e})]})}},2324:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});n(6540);var o=n(8478),r=n(4848);function a(){return(0,r.jsx)("div",{className:"map-fullscreen-page",children:(0,r.jsx)(o.A,{fallback:(0,r.jsx)("div",{className:"map-loading",children:"Lade Map \u2026"}),children:()=>{const e=n(980).A;return(0,r.jsx)(e,{})}})})}},9804:(e,t,n)=>{var o={"./2900.json":4123,"./2901.json":4776,"./2902-4.json":1680};function r(e){var t=a(e);return n(t)}function a(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=a,e.exports=r,r.id=9804},4123:e=>{"use strict";e.exports=JSON.parse('{"type":"FeatureCollection","features":[{"type":"Feature","id":"","crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:EPSG::25832"}},"geometry":{"type":"MultiPolygon","coordinates":[[[[380010.263,5461291.585],[380015.4,5461282.694],[380019.601,5461275.423],[380129.491,5461322.236],[380206.181,5461354.506],[380184.555,5461354.095],[380162.139,5461353.667],[380113.465,5461332.924],[380010.263,5461291.585]]],[[[380167.795,5461356.078],[380190.747,5461356.45],[380211.601,5461356.787],[380275.618,5461381.9],[380272.181,5461389.388],[380267.354,5461399.905],[380203.984,5461370.015],[380203.331,5461371.222],[380167.795,5461356.078]]],[[[379939.204,5461241.569],[379988.892,5461262.341],[379986.214,5461263.665],[379983.471,5461264.841],[379977.776,5461267.232],[379967.896,5461271.379],[379964.562,5461272.341],[379962.276,5461272.376],[379960.778,5461272.049],[379957.176,5461269.871],[379951.333,5461264.516],[379948.475,5461261.645],[379947.044,5461259.594],[379946.001,5461257.838],[379942.427,5461250.114],[379939.204,5461241.569]]],[[[379968.799,5461274.975],[379976.429,5461272.011],[379980.861,5461269.763],[379982.902,5461268.728],[379992.332,5461263.806],[380015.92,5461273.855],[380014.484,5461276.167],[380011.853,5461281.161],[380007.04,5461290.294],[379968.799,5461274.975]]]]},"properties":{"NAME":"2100","FLUR_NR":"12","FLZ":"2900","ID":""}}]}')},4776:e=>{"use strict";e.exports=JSON.parse('{"type":"FeatureCollection","features":[{"type":"Feature","id":"","crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:EPSG::25832"}},"geometry":{"type":"MultiPolygon","coordinates":[[[[380002.249,5461307.434],[380004.074,5461303.551],[380006.515,5461298.832],[380010.263,5461291.585],[380113.465,5461332.924],[380162.139,5461353.667],[380141.649,5461354.072],[380119.484,5461354.509],[380002.249,5461307.434]]],[[[380124.446,5461356.501],[380147.12,5461356.28],[380167.795,5461356.078],[380203.331,5461371.222],[380203.984,5461370.015],[380267.354,5461399.905],[380266.866,5461400.968],[380262.821,5461409.782],[380259.339,5461417.367],[380259.397,5461418.548],[380196.182,5461385.306],[380124.446,5461356.501]]],[[[379945.294,5461264.461],[379949.282,5461268.439],[379953.418,5461271.967],[379956.76,5461274.359],[379959.831,5461275.975],[379962.201,5461276.547],[379964.396,5461276.259],[379968.799,5461274.975],[380007.04,5461290.294],[380003.254,5461297.481],[380002.519,5461298.876],[379999.113,5461306.175],[379939.097,5461282.076],[379944.336,5461267.185],[379944.825,5461265.793],[379945.294,5461264.461]]]]},"properties":{"NAME":"2100","FLUR_NR":"12","FLZ":"2901","ID":""}}]}')},1680:e=>{"use strict";e.exports=JSON.parse('{"type":"FeatureCollection","features":[{"type":"Feature","id":"","crs":{"type":"name","properties":{"name":"urn:ogc:def:crs:EPSG::25832"}},"geometry":{"type":"Polygon","coordinates":[[[380186.259,5461403.009],[380196.182,5461385.306],[380259.397,5461418.548],[380259.092,5461435.55],[380186.259,5461403.009]]]},"properties":{"NAME":"2100","FLUR_NR":"12","FLZ":"2902","ID":"4"}}]}')}}]);